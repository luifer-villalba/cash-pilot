<!-- File: templates/businesses/edit.html -->
{% extends "base.html" %}

{% block title %}{{ _('Edit Business') }}{% endblock %}

{% block content %}
<div class="container mx-auto px-4 py-6 max-w-2xl">
    <div class="flex items-center justify-between mb-6">
        <h1 class="text-3xl font-bold">{{ _('Edit Business') }}</h1>
        <a href="/businesses" class="btn btn-ghost btn-sm" data-back>{{ _('Back') }}</a>
    </div>

    <div class="card bg-base-100 shadow-xl">
        <div class="card-body">
            <!-- Business Info Form -->
            <form method="POST" action="/businesses/{{ business.id }}" class="space-y-4" onsubmit="document.getElementById('save-loading').classList.remove('hidden');">
                <!-- Name -->
                <div class="form-control">
                    <label class="label pb-2">
                        <span class="label-text text-xs font-bold uppercase tracking-wider text-base-content/70">{{ _('Name') }} *</span>
                    </label>
                    <input 
                        type="text" 
                        name="name" 
                        id="name"
                        class="input input-sm input-bordered w-full focus:ring-2 focus:ring-primary/20 transition-all"
                        value="{{ business.name }}"
                        required 
                        minlength="1" 
                        maxlength="200"
                        aria-describedby="name-help"
                    />
                    <label class="label pt-2" id="name-help">
                        <span class="label-text-alt text-xs text-base-content/60">{{ _('Business location name') }}</span>
                    </label>
                </div>

                <!-- Address -->
                <div class="form-control">
                    <label class="label pb-2">
                        <span class="label-text text-xs font-bold uppercase tracking-wider text-base-content/70">{{ _('Address') }}</span>
                    </label>
                    <input 
                        type="text" 
                        name="address" 
                        id="address"
                        class="input input-sm input-bordered w-full focus:ring-2 focus:ring-primary/20 transition-all"
                        value="{{ business.address or '' }}"
                        maxlength="500"
                        aria-describedby="address-help"
                    />
                    <label class="label pt-2" id="address-help">
                        <span class="label-text-alt text-xs text-base-content/60">{{ _('Optional: Street address') }}</span>
                    </label>
                </div>

                <!-- Phone -->
                <div class="form-control">
                    <label class="label pb-2">
                        <span class="label-text text-xs font-bold uppercase tracking-wider text-base-content/70">{{ _('Phone') }}</span>
                    </label>
                    <input 
                        type="tel" 
                        name="phone" 
                        id="phone"
                        class="input input-sm input-bordered w-full focus:ring-2 focus:ring-primary/20 transition-all"
                        value="{{ business.phone or '' }}"
                        maxlength="50"
                        aria-describedby="phone-help"
                    />
                    <label class="label pt-2" id="phone-help">
                        <span class="label-text-alt text-xs text-base-content/60">{{ _('Optional: Contact phone number') }}</span>
                    </label>
                </div>

                <!-- Status -->
                <div class="form-control">
                    <label class="label pb-2">
                        <span class="label-text text-xs font-bold uppercase tracking-wider text-base-content/70">{{ _('Active') }}</span>
                    </label>
                    <input 
                        type="checkbox" 
                        name="is_active" 
                        id="is_active"
                        class="toggle toggle-primary focus:ring-2 focus:ring-primary/20 transition-all"
                        {% if business.is_active %}checked{% endif %}
                        aria-describedby="is-active-help"
                    />
                    <label class="label pt-2" id="is-active-help">
                        <span class="label-text-alt text-xs text-base-content/60">{{ _('Enable or disable this business location') }}</span>
                    </label>
                </div>

                <!-- Save Button -->
                <div class="flex gap-3 pt-2">
                    <button 
                        type="submit" 
                        class="btn btn-primary btn-sm flex-[2] gap-2 shadow-sm transition-all hover:scale-[1.02] active:scale-[0.98] focus:outline-none focus:ring-2 focus:ring-primary/50"
                        aria-label="{{ _('Save business changes') }}"
                    >
                        <span class="loading loading-spinner loading-sm hidden" id="save-loading"></span>
                        {{ _('Save Changes') }}
                    </button>
                    <a 
                        href="/businesses" 
                        class="btn btn-outline btn-sm flex-1 transition-all hover:scale-[1.02] active:scale-[0.98] focus:outline-none focus:ring-2 focus:ring-base-content/20"
                        aria-label="{{ _('Cancel and return to businesses list') }}"
                    >
                        {{ _('Cancel') }}
                    </a>
                </div>
            </form>

            <div class="divider"></div>

            <!-- Business Info Summary -->
            <div class="space-y-3">
                <h3 class="text-xl font-bold">{{ _('Business Info') }}</h3>

                <div class="stats stats-vertical lg:stats-horizontal shadow w-full">
                    <div class="stat">
                        <div class="stat-title">{{ _('Created') }}</div>
                        <div class="stat-value text-sm">{{ business.created_at | format_date_business }}</div>
                    </div>
                    <div class="stat">
                        <div class="stat-title">{{ _('Updated') }}</div>
                        <div class="stat-value text-sm">{{ business.updated_at | format_date_business }}</div>
                    </div>
                    <div class="stat">
                        <div class="stat-title">{{ _('Assigned Users') }}</div>
                        <div class="stat-value text-sm">{{ business.users|length }}</div>
                    </div>
                </div>

                <div class="alert alert-info">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" class="stroke-current shrink-0 w-6 h-6"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
                    <span>To manage users assigned to this business, go to <a href="/admin/users-page" class="link link-primary font-bold">Admin â†’ Users</a></span>
                </div>
            </div>

            <!-- Back Button -->
            <div class="card-actions justify-end mt-4">
                <a href="/businesses" class="btn btn-outline" data-back>{{ _('Back to Businesses') }}</a>
            </div>
        </div>
    </div>
</div>
{% endblock %}
