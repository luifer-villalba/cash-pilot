{% extends "base.html" %}

{% block title %}{{ _('Businesses') }} - CashPilot{% endblock %}

{% block content %}
<div class="px-4 py-6 md:px-6">
    <!-- Header -->
    <div class="flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4 mb-6">
        <h1 class="text-3xl md:text-4xl font-bold">{{ _('Businesses') }}</h1>
        <a href="/businesses/new" class="btn btn-primary w-full sm:w-auto">
            {{ _('+ New Business') }}
        </a>
    </div>

    <!-- Businesses Grid -->
    {% if businesses %}
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
        {% for business in businesses %}
        <div class="card bg-base-100 shadow hover:shadow-lg transition-shadow duration-200 {% if not business.is_active %}opacity-75{% endif %}">
            <div class="card-body p-4">
                <!-- Title & Status -->
                <div class="flex justify-between items-start gap-2 mb-3">
                    <h2 class="card-title text-lg md:text-xl break-words">{{ business.name }}</h2>
                    {% if business.is_active %}
                        <span class="inline-flex items-center gap-2 px-3 py-1 rounded-full bg-success/20 text-success font-semibold text-xs whitespace-nowrap">
                            <span class="w-2 h-2 rounded-full bg-success animate-pulse"></span>
                            {{ _('Active') }}
                        </span>
                    {% else %}
                        <span class="inline-flex items-center gap-2 px-3 py-1 rounded-full bg-neutral/20 text-neutral font-semibold text-xs whitespace-nowrap">
                            <span class="w-2 h-2 rounded-full bg-neutral"></span>
                            {{ _('Inactive') }}
                        </span>
                    {% endif %}
                </div>

                <!-- Info -->
                <div class="space-y-2 text-sm mb-4">
                    {% if business.address %}
                    <div class="flex gap-2">
                        <span class="text-gray-500 min-w-fit">ğŸ“</span>
                        <span class="break-words">{{ business.address }}</span>
                    </div>
                    {% endif %}

                    {% if business.phone %}
                    <div class="flex gap-2">
                        <span class="text-gray-500 min-w-fit">ğŸ“</span>
                        <a href="tel:{{ business.phone }}" class="link link-hover">{{ business.phone }}</a>
                    </div>
                    {% endif %}
                </div>

                <!-- Cashiers -->
                {% if business.cashiers %}
                <div class="mb-4">
                    <p class="text-xs font-semibold text-gray-500 mb-2">{{ _('Cashiers') }}</p>
                    <div class="flex flex-wrap gap-2">
                        {% for cashier in business.cashiers[:3] %}
                            <span class="inline-flex items-center px-2 py-1 bg-info text-info-content rounded text-xs font-medium">
                                {{ cashier }}
                            </span>
                        {% endfor %}
                        {% if business.cashiers|length > 3 %}
                            <span class="inline-flex items-center px-2 py-1 bg-base-300 text-base-content rounded text-xs font-medium">
                                +{{ business.cashiers|length - 3 }}
                            </span>
                        {% endif %}
                    </div>
                </div>
                {% endif %}

                <!-- Actions -->
                <div class="card-actions justify-end gap-2 mt-4">
                    <a href="/businesses/{{ business.id }}/edit" class="btn btn-sm btn-outline btn-primary w-full">
                        {{ _('Edit') }}
                    </a>
                </div>
            </div>
        </div>
        {% endfor %}
    </div>
    {% else %}
    <div class="alert alert-info">
        <span>{{ _('No businesses found.') }} <a href="/businesses/new" class="link link-hover">{{ _('Create one') }}</a></span>
    </div>
    {% endif %}
</div>
{% endblock %}